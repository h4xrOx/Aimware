<!DOCTYPE html>
<html lang=zh>
<head>
<title>code - Aimware Library API</title>
<meta charset=utf-8>
<meta name="keywords" content="易文档,EasyDoc,code,Aimware Library API,接口文档工具,在线接口文档管理平台,接口测试,api文档编写工具,api文档管理平台,mock接口">
<meta name="description" content="Aimware Library API - code，lualocal M = {}---- dependencies--local ffi = re,技术团队的文档管理平台，接口文档工具，支持在线接口调试，一键生成API文档，适合编写接口文档、产品文档、使用手册">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"><script defer src="https://res.easydoc.net/preview/static/main.22a17828.js"></script><link href="https://res.easydoc.net/preview/static/main.5aa3b16f.css" rel="stylesheet"></head>

<body>



    <div id="app" class=" middle">

<header id="header">
    <div class="header-wrapper container desk">
        <div class="header-content">
            <div class="header-left">
                <div class="project-title text-hidden" title="Aimware Libraries">Aimware Libraries</div>
            </div>
            <div class="header-mid">
                <nav class="nav-list-wrapper">
                </nav>
            </div>
            <div class="header-right">
                <div class="search-input-wrapper">
                    <i class="fa fa-search" aria-hidden="true"></i>
                    <input type="text" class="search-input" placeholder="搜索">
                </div>
            </div>
        </div>
    </div>

    <div class="header-wrapper container mobile">
        <div class="menus-wrapper">
            <span class="menus-text">目录</span>
        </div>
        <h2 class="doc-title text-hidden">
            code
        </h2>
    </div>
</header>
        <div class="content-wrapper">
            <div class="container">
                <!-- 左右半部分白色背景 -->
                <div class="left-half-bg"></div>
                <div class="right-half-bg"></div>

                <div class="content" data-type="markdown">
                    <aside class="content-left">
                        <div class="content-left-main">
                            <div class="project-title-wrapper">
                                <h2 class="project-title">
                                    Aimware Library API
                                </h2>
                                
                                <div class="search-wrapper">
                                    <i class="fa fa-search" aria-hidden="true" style="font-size: 14px;"></i>
                                    <input type="text" class="search-title-input" placeholder="搜索文档">
                                    <span class="search-tips" title="点击进行全文搜索">全</span>
                                </div>


                            </div>
                            
                            <div class="article-list-wrapper left-nav">
<ul class="article-list">
    <li class="article-list-item "
        data-type="folder"
        data-id="ktzty4by"
        data-pid=""
        data-level="0"
        data-children="5"
        data-collection="">

        <!-- 文档 -->
        <a href="https://easydoc.net/doc/99888156/v49iFg8X/ktzty4by" class="article-title text-hidden" title="images" style="padding-left: 24px; padding-right: 10px;">
                <i class="fa fa-angle-right" aria-hidden="true"></i>
            images
        </a>
        <!-- 集合 -->

<ul class="article-list">
    <li class="article-list-item "
        data-type="doc"
        data-id="A3MNAeYC"
        data-pid=""
        data-level="1"
        data-children="0"
        data-collection="">

        <!-- 文档 -->
        <a href="A3MNAeYC.html" class="article-title text-hidden" title="code" style="padding-left: 24px; padding-right: 10px;">
                <span class="article-icon"></span>
            code
        </a>
        <!-- 集合 -->

    </li>
    <li class="article-list-item "
        data-type="doc"
        data-id="YyqSLLXz"
        data-pid=""
        data-level="1"
        data-children="0"
        data-collection="">

        <!-- 文档 -->
        <a href="YyqSLLXz.html" class="article-title text-hidden" title="module" style="padding-left: 24px; padding-right: 10px;">
                <span class="article-icon"></span>
            module
        </a>
        <!-- 集合 -->

    </li>
    <li class="article-list-item "
        data-type="doc"
        data-id="ve3A6GXa"
        data-pid=""
        data-level="1"
        data-children="0"
        data-collection="">

        <!-- 文档 -->
        <a href="ve3A6GXa.html" class="article-title text-hidden" title="class" style="padding-left: 24px; padding-right: 10px;">
                <span class="article-icon"></span>
            class
        </a>
        <!-- 集合 -->

    </li>
    <li class="article-list-item "
        data-type="doc"
        data-id="5Egd1y0M"
        data-pid=""
        data-level="1"
        data-children="0"
        data-collection="">

        <!-- 文档 -->
        <a href="5Egd1y0M.html" class="article-title text-hidden" title="table" style="padding-left: 24px; padding-right: 10px;">
                <span class="article-icon"></span>
            table
        </a>
        <!-- 集合 -->

    </li>
    <li class="article-list-item "
        data-type="doc"
        data-id="5gIufRZ2"
        data-pid=""
        data-level="1"
        data-children="0"
        data-collection="">

        <!-- 文档 -->
        <a href="5gIufRZ2.html" class="article-title text-hidden" title="examples" style="padding-left: 24px; padding-right: 10px;">
                <span class="article-icon"></span>
            examples
        </a>
        <!-- 集合 -->

    </li>
</ul>    </li>
</ul>                            </div>
                            <div class="bottom-wrapper">
                                <div class="bottom-content">
                                    <a href="https://easydoc.net/" target="_blank" class="bottom-link">本文档使用<span style="font-weight: 700;margin: 0 5px;">易文档</span>进行构建</a>
                                </div>
                            </div>
                        </div>
                        <!-- 抽屉弹窗部分 -->
                        <div class="drawer-wrapper">
                            <div class="drawer-content" style="transform: translateX(0)">
                                <div class="drawer-header">
                                    <div class="header-left">更新日志</div>
                                </div>

                                <div class="drawer-slot">
                                    <!-- 更新日志 -->
                                    <div class="project-log-wrapper">
                                        <div class="project-log-content">
                                            <ul class="project-log-list"></ul>
                                        </div>
                                    </div>

                                    <!-- 其他 -->
                                </div>
                            </div>
                        </div>
                    </aside>
                    <main class="content-mid">
                        <div class="doc-wrapper">
                            <div class="doc-content markdown">
<h1 class="doc-h1-title">code</h1>
<article class="markdown-body ">```lua
local M = {}

--
-- dependencies
--

local ffi = require &quot;ffi&quot;
local vtable = require &quot;vtable&quot;
local csgo_weapons = require &quot;csgo_weapons&quot;

local string_gsub = string.gsub
local math_floor = math.floor
local cast = ffi.cast

--
-- ffi structs
-- (mostly for image parsing)
--

local png_ihdr_t =
	ffi.typeof(
	[[
struct {
	char type[4];
	uint32_t width;
	uint32_t height;
	char bitDepth;
	char colorType;
	char compression;
	char filter;
	char interlace;
} *
]]
)

local jpg_segment_t = ffi.typeof([[
struct {
	char type[2];
	uint16_t size;
} *
]])

local jpg_segment_sof0_t =
	ffi.typeof([[
struct {
	uint16_t size;
	char precision;
	uint16_t height;
	uint16_t width;
} __attribute__((packed)) *
]])

local uint16_t_ptr = ffi.typeof(&quot;uint16_t*&quot;)
local charbuffer = ffi.typeof(&quot;char[?]&quot;)
local uintbuffer = ffi.typeof(&quot;unsigned int[?]&quot;)

--
-- constants
--

local INVALID_TEXTURE = -1
local PNG_MAGIC = &quot;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A&quot;

local JPG_MAGIC_1 = &quot;\xFF\xD8\xFF\xDB&quot;
local JPG_MAGIC_2 = &quot;\xFF\xD8\xFF\xE0\x00\x10\x4A\x46\x49\x46\x00\x01&quot;

local JPG_SEGMENT_SOI = &quot;\xFF\xD8&quot;
local JPG_SEGMENT_SOF0 = &quot;\xFF\xC0&quot;
local JPG_SEGMENT_SOS = &quot;\xFF\xDA&quot;
local JPG_SEGMENT_EOI = &quot;\xFF\xD9&quot;

local RENDERER_LOAD_FUNCS = {
	png = function(contents, width, height)
		local rgba, _width, _height = common.DecodePNG(contents)
		return draw.CreateTexture(rgba, _width, _height)
	end,
	svg = function(contents, width, height)
		local rgba, _width, _height = common.RasterizeSVG(contents)
		return draw.CreateTexture(rgba, _width, _height)
	end,
	jpg = function(contents, width, height)
		local rgba, _width, _height = common.DecodeJPEG(contents)
		return draw.CreateTexture(rgba, _width, _height)
	end,
	rgba = draw.CreateTexture
}

--
-- utility functions
--

local function bswap_16(x)
	return bit.rshift(bit.bswap(x), 16)
end

local function hexdump(str)
	local out = {}
	str:gsub(
		&quot;.&quot;,
		function(chr)
			table.insert(out, string.format(&quot;%02x&quot;, string.byte(chr)))
		end
	)
	return table.concat(out, &quot; &quot;)
end

--
-- small filesystem implementation
--

local native_ReadFile = vtable.bind(&quot;filesystem_stdio.dll&quot;, &quot;VBaseFileSystem011&quot;, 0, &quot;int(__thiscall*)(void*, void*, int, void*)&quot;)
local native_OpenFile =
	vtable.bind(&quot;filesystem_stdio.dll&quot;, &quot;VBaseFileSystem011&quot;, 2, &quot;void*(__thiscall*)(void*, const char*, const char*, const char*)&quot;)
local native_CloseFile = vtable.bind(&quot;filesystem_stdio.dll&quot;, &quot;VBaseFileSystem011&quot;, 3, &quot;void(__thiscall*)(void*, void*)&quot;)
local native_GetFileSize = vtable.bind(&quot;filesystem_stdio.dll&quot;, &quot;VBaseFileSystem011&quot;, 7, &quot;unsigned int(__thiscall*)(void*, void*)&quot;)

local function engine_read_file(filename)
	local handle = native_OpenFile(filename, &quot;r&quot;, &quot;MOD&quot;)
	if handle == nil then
		return
	end

	local filesize = native_GetFileSize(handle)
	if filesize == nil or filesize &lt; 0 then
		return
	end

	local buffer = charbuffer(filesize + 1)
	if buffer == nil then
		return
	end

	local read_success = native_ReadFile(buffer, filesize, handle)
	if not read_success then
		return
	end

	return ffi.string(buffer, filesize)
end

--
-- ISteamFriends / ISteamUtils
--

-- That shit now use ingame context of steamapi instead of connecting to global user
-- enjoy, by w7rus

ffi.cdef(
	[[
	typedef struct
	{
		void* steam_client;
		void* steam_user;
		void* steam_friends;
		void* steam_utils;
		void* steam_matchmaking;
		void* steam_user_stats;
		void* steam_apps;
		void* steam_matchmakingservers;
		void* steam_networking;
		void* steam_remotestorage;
		void* steam_screenshots;
		void* steam_http;
		void* steam_unidentifiedmessages;
		void* steam_controller;
		void* steam_ugc;
		void* steam_applist;
		void* steam_music;
		void* steam_musicremote;
		void* steam_htmlsurface;
		void* steam_inventory;
		void* steam_video;
	} S_steamApiCtx_t;
]]
)

local pS_SteamApiCtx =
	ffi.cast(&quot;S_steamApiCtx_t**&quot;, ffi.cast(&quot;char*&quot;, mem.FindPattern(&quot;client.dll&quot;, &quot;FF 15 ?? ?? ?? ?? B9 ?? ?? ?? ?? E8 ?? ?? ?? ?? 6A&quot;)) + 7)[0] or
	error(&quot;invalid interface&quot;, 2)

local native_ISteamFriends = ffi.cast(&quot;void***&quot;, pS_SteamApiCtx.steam_friends)
local native_ISteamUtils = ffi.cast(&quot;void***&quot;, pS_SteamApiCtx.steam_utils)

local native_ISteamFriends_GetSmallFriendAvatar = vtable.thunk(34, &quot;int(__thiscall*)(void*, uint64_t)&quot;)
local native_ISteamFriends_GetMediumFriendAvatar = vtable.thunk(35, &quot;int(__thiscall*)(void*, uint64_t)&quot;)
local native_ISteamFriends_GetLargeFriendAvatar = vtable.thunk(36, &quot;int(__thiscall*)(void*, uint64_t)&quot;)

local native_ISteamUtils_GetImageSize = vtable.thunk(5, &quot;bool(__thiscall*)(void*, int, uint32_t*, uint32_t*)&quot;)
local native_ISteamUtils_GetImageRGBA = vtable.thunk(6, &quot;bool(__thiscall*)(void*, int, unsigned char*, int)&quot;)

--
-- image object implementation
--

local function image_measure(self, width, height)
	if width ~= nil and height ~= nil then
		return math_floor(width), math_floor(height)
	else
		if self.width == nil or self.height == nil then
			error(&quot;Image dimensions not known, full size is required&quot;)
		elseif width == nil then
			height = height or self.height
			local width = math_floor(self.width * (height / self.height))
			return width, height
		elseif height == nil then
			width = width or self.width
			local height = math_floor(self.height * (width / self.width))
			return width, height
		else
			return math_floor(self.width), math_floor(self.height)
		end
	end
end

local function image_draw(self, x, y, width, height, r, g, b, a, force_same_res_render)
	width, height = image_measure(self, width, height)

	local id = string.format(&quot;%f_%f&quot;, width, height)
	local texture = self.textures[id]

	-- no texture with same width and height has been loaded
	if texture == nil then
		if ({next(self.textures)})[2] == nil or force_same_res_render or force_same_res_render == nil then
			-- try and load the texture
			local func = RENDERER_LOAD_FUNCS[self.type]
			if func then
				if self.type == &quot;rgba&quot; then
					width, height = self.width, self.height
				end
				texture = func(self.contents, width, height)
			end

			if texture == nil then
				self.textures[id] = INVALID_TEXTURE
				error(&quot;failed to load texture for &quot; .. width .. &quot;x&quot; .. height, 2)
			else
				-- client.log(&quot;loaded svg &quot;, self.name, &quot; for &quot;, width, &quot;x&quot;, height)
				self.textures[id] = texture
			end
		else
			--right now we just choose a random texture (determined by the pairs order aka unordered)
			--todo: select the texture with the highest or closest resolution?
			texture = ({next(self.textures)})[2]
		end
	end

	if texture == nil or texture == INVALID_TEXTURE then
		return
	elseif a == nil or a &gt; 0 then
		draw.SetTexture(texture)

		draw.Color(r or 255, g or 255, b or 255, a or 255)
		draw.FilledRect(x, y, x + width, y + height)
		draw.SetTexture(nil)
	end

	return width, height
end

local image_mt = {
	__index = {
		measure = image_measure,
		draw = image_draw
	}
}

--
-- functions for loading images
--

local function load_png(contents)
	if contents:sub(1, 8) ~= PNG_MAGIC then
		error(&quot;Invalid magic&quot;, 2)
		return
	end

	local ihdr_raw = contents:sub(13, 30)
	if ihdr_raw:len() &lt; 17 then
		error(&quot;Incomplete data&quot;, 2)
		return
	end

	local ihdr = cast(png_ihdr_t, cast(&quot;const uint8_t *&quot;, cast(&quot;const char*&quot;, ihdr_raw)))

	if ffi.string(ihdr.type, 4) ~= &quot;IHDR&quot; then
		error(&quot;Invalid chunk type, expected IHDR&quot;, 2)
		return
	end

	local width = bit.bswap(ihdr.width)
	local height = bit.bswap(ihdr.height)

	if width &lt;= 0 or height &lt;= 0 then
		error(&quot;Invalid width or height&quot;, 2)
		return
	end

	return setmetatable(
		{
			type = &quot;png&quot;,
			width = width,
			height = height,
			contents = contents,
			textures = {}
		},
		image_mt
	)
end

local function load_jpg(contents)
	local buffer = ffi.cast(&quot;const uint8_t *&quot;, ffi.cast(&quot;const char *&quot;, contents))
	local len_remaining = contents:len()

	local width, height

	if contents:sub(1, 4) == JPG_MAGIC_1 or contents:sub(1, 12) == JPG_MAGIC_2 then
		local got_soi, got_sos = false, false

		-- read segments until we find a SOF0 header (containing width/height)
		while len_remaining &gt; 0 do
			local segment = ffi.cast(jpg_segment_t, buffer)
			local typ = ffi.string(segment.type, 2)

			buffer = buffer + 2
			len_remaining = len_remaining - 2

			if typ == JPG_SEGMENT_SOI then
				got_soi = true
			elseif not got_soi then
				error(&quot;expected SOI segment&quot;, 2)
			elseif typ == JPG_SEGMENT_SOS or typ == JPG_SEGMENT_EOI then
				if typ == JPG_SEGMENT_SOS then
					got_sos = true
				end
				break
			else
				-- endian convert of the size (be -&gt; le)
				local size = bswap_16(segment.size)

				if typ == JPG_SEGMENT_SOF0 then
					local sof0 = cast(jpg_segment_sof0_t, buffer)

					height = bswap_16(sof0.height)
					width = bswap_16(sof0.width)

					if width &lt;= 0 or height &lt;= 0 then
						error(&quot;Invalid width or height&quot;)
						return
					end
				end

				buffer = buffer + size
				len_remaining = len_remaining - size
			end
		end

		if not got_soi then
			error(&quot;Incomplete image, missing SOI segment&quot;, 2)
			return
		elseif not got_sos then
			error(&quot;Incomplete image, missing SOS segment&quot;, 2)
			return
		elseif width == nil then
			error(&quot;Incomplete image, missing SOF0 segment&quot;, 2)
			return
		end
	else
		error(&quot;Invalid magic&quot;, 2)
		return
	end

	return setmetatable(
		{
			type = &quot;jpg&quot;,
			width = width,
			height = height,
			contents = contents,
			textures = {}
		},
		image_mt
	)
end

local function load_svg(contents)
	-- try and find &lt;svg&gt; tag

	local match = contents:match(&quot;&lt;svg(.*)&gt;.*&lt;/svg&gt;&quot;)
	if match == nil then
		error(&quot;Invalid svg, missing &lt;svg&gt; tag&quot;, 2)
		return
	end

	match = match:gsub(&quot;\r\n&quot;, &quot;&quot;):gsub(&quot;\n&quot;, &quot;&quot;)

	-- parse tag contents
	local in_quote = false
	local key, value = &quot;&quot;, &quot;&quot;

	local attributes = {}

	local offset = 1
	while true do
		local chr = match:sub(offset, offset)

		if chr == &quot;&quot; then
			break
		end

		if in_quote then
			-- text inside quotation marks
			if chr == &#039;&quot;&#039; then
				in_quote = false
				attributes[key:gsub(&quot;\t&quot;, &quot;&quot;):lower()] = value
				key, value = &quot;&quot;, &quot;&quot;
			else
				value = value .. chr
			end
		else
			-- normal text, not inside quotes
			if chr == &quot;&gt;&quot; then
				break
			elseif chr == &quot;=&quot; then
				if match:sub(offset, offset + 1) == &#039;=&quot;&#039; then
					in_quote = true
					offset = offset + 1
				end
			elseif chr == &quot; &quot; then
				key = &quot;&quot;
			else
				key = key .. chr
			end
		end

		offset = offset + 1
	end

	-- heuristics to find valid image width and height
	local width, height

	if attributes[&quot;width&quot;] ~= nil then
		width = tonumber((attributes[&quot;width&quot;]:gsub(&quot;px$&quot;, &quot;&quot;):gsub(&quot;pt$&quot;, &quot;&quot;):gsub(&quot;mm$&quot;, &quot;&quot;)))

		if width ~= nil and 0 &gt;= width then
			width = nil
		end
	end

	if attributes[&quot;height&quot;] ~= nil then
		height = tonumber((attributes[&quot;height&quot;]:gsub(&quot;px$&quot;, &quot;&quot;):gsub(&quot;pt$&quot;, &quot;&quot;):gsub(&quot;mm$&quot;, &quot;&quot;)))

		if height ~= nil and 0 &gt;= height then
			height = nil
		end
	end

	if width == nil or height == nil and attributes[&quot;viewbox&quot;] ~= nil then
		local x, y, w, h = attributes[&quot;viewbox&quot;]:match(&quot;^%s*([%d.]*) ([%d.]*) ([%d.]*) ([%d.]*)%s*$&quot;)

		width, height = tonumber(width), tonumber(height)

		if width ~= nil and height ~= nil and (0 &gt;= width or 0 &gt;= height) then
			width, height = nil, nil
		end
	end

	local self =
		setmetatable(
		{
			type = &quot;svg&quot;,
			contents = contents,
			textures = {}
		},
		image_mt
	)

	if width ~= nil and height ~= nil and width &gt; 0 and height &gt; 0 then
		self.width, self.height = width, height
	end

	return self
end

local function load_rgba(contents, width, height)
	if width == nil or height == nil or width &lt;= 0 or height &lt;= 0 then
		error(&quot;Invalid size: width and height are required and have to be greater than zero.&quot;)
		return
	end

	local size = width * height * 4
	if contents:len() ~= size then
		error(&quot;invalid buffer length, expected width*height*4&quot;, 2)
		return
	end

	-- load texture
	local texture = draw.CreateTexture(contents, width, height)
	if texture == nil then
		return
	end

	return setmetatable(
		{
			type = &quot;rgba&quot;,
			width = width,
			height = height,
			contents = contents,
			textures = {[string.format(&quot;%f_%f&quot;, width, height)] = texture}
		},
		image_mt
	)
end

local function load_image(contents)
	if type(contents) == &quot;table&quot; then
		if getmetatable(contents) == image_mt then
			return error(&quot;trying to load an existing image&quot;)
		else
			local result = {}
			for key, value in pairs(contents) do
				result[key] = load_image(value)
			end
			return result
		end
	else
		-- try and determine type etc by looking for magic value
		if type(contents) == &quot;string&quot; then
			if contents:sub(1, 8) == PNG_MAGIC then
				return load_png(contents)
			elseif contents:sub(1, 4) == JPG_MAGIC_1 or contents:sub(1, 12) == JPG_MAGIC_2 then
				return load_jpg(contents)
			elseif contents:match(&quot;^%s*%&lt;%?xml&quot;) ~= nil then
				return load_svg(contents)
			else
				return error(&quot;Failed to determine image type&quot;)
			end
		end
	end
end

local panorama_images = setmetatable({}, {__mode = &quot;k&quot;})
local function get_panorama_image(path)
	if panorama_images[path] == nil then
		local path_cleaned = string_gsub(string_gsub(string_gsub(string_gsub(string_gsub(path, &quot;%z&quot;, &quot;&quot;), &quot;%c&quot;, &quot;&quot;), &quot;\\&quot;, &quot;/&quot;), &quot;%.%./&quot;, &quot;&quot;), &quot;^/+&quot;, &quot;&quot;)
		local contents = engine_read_file(&quot;materials/panorama/images/&quot; .. path_cleaned)

		if contents then
			local image = load_image(contents)

			panorama_images[path] = image
		else
			panorama_images[path] = false
		end
	end

	if panorama_images[path] then
		return panorama_images[path]
	end
end

local weapon_icons = setmetatable({}, {__mode = &quot;k&quot;})
local function get_weapon_icon(weapon_name)
	if weapon_icons[weapon_name] == nil then
		local weapon_name_cleaned
		local typ = type(weapon_name)

		if typ == &quot;table&quot; and weapon_name.console_name ~= nil then
			weapon_name_cleaned = weapon_name.console_name
		elseif typ == &quot;number&quot; then
			local weapon = csgo_weapons[weapon_name]
			if weapon == nil then
				weapon_icons[weapon_name] = false
				return
			end
			weapon_name_cleaned = weapon.console_name
		elseif typ == &quot;string&quot; then
			weapon_name_cleaned = tostring(weapon_name)
		elseif weapon_name ~= nil then
			weapon_icons[weapon_name] = nil
			return
		else
			return
		end

		weapon_name_cleaned = string_gsub(string_gsub(weapon_name_cleaned, &quot;^weapon_&quot;, &quot;&quot;), &quot;^item_&quot;, &quot;&quot;)

		local image = get_panorama_image(&quot;icons/equipment/&quot; .. weapon_name_cleaned .. &quot;.svg&quot;)
		weapon_icons[weapon_name] = image or false
	end

	if weapon_icons[weapon_name] then
		return weapon_icons[weapon_name]
	end
end

local steam_avatars = {}
local function get_steam_avatar(steamid3_or_steamid64, size)
	local cache_key = string.format(&quot;%s_%d&quot;, steamid3_or_steamid64, size or 32)

	if steam_avatars[cache_key] == nil then
		local func
		if size == nil then
			func = native_ISteamFriends_GetSmallFriendAvatar
		elseif size &gt; 64 then
			func = native_ISteamFriends_GetLargeFriendAvatar
		elseif size &gt; 32 then
			func = native_ISteamFriends_GetMediumFriendAvatar
		else
			func = native_ISteamFriends_GetSmallFriendAvatar
		end

		local steamid
		if type(steamid3_or_steamid64) == &quot;string&quot; then
			steamid = 76500000000000000ULL + tonumber(steamid3_or_steamid64:sub(4, -1))
		elseif type(steamid3_or_steamid64) == &quot;number&quot; then
			steamid = 76561197960265728ULL + steamid3_or_steamid64
		else
			return
		end

		local handle = func(native_ISteamFriends, steamid)

		if handle &gt; 0 then
			local width = uintbuffer(1)
			local height = uintbuffer(1)
			if native_ISteamUtils_GetImageSize(native_ISteamUtils, handle, width, height) then
				if width[0] &gt; 0 and height[0] &gt; 0 then
					local rgba_buffer_size = width[0] * height[0] * 4
					local rgba_buffer = charbuffer(rgba_buffer_size)

					if native_ISteamUtils_GetImageRGBA(native_ISteamUtils, handle, rgba_buffer, rgba_buffer_size) then
						steam_avatars[cache_key] = load_rgba(ffi.string(rgba_buffer, rgba_buffer_size), width[0], height[0])
					end
				end
			end
		elseif handle ~= -1 then
			steam_avatars[cache_key] = false
		end
	end

	if steam_avatars[cache_key] then
		return steam_avatars[cache_key]
	end
end

return {
	load = load_image,
	load_png = load_png,
	load_jpg = load_jpg,
	load_svg = load_svg,
	load_rgba = load_rgba,
	get_weapon_icon = get_weapon_icon,
	get_panorama_image = get_panorama_image,
	get_steam_avatar = get_steam_avatar
}
```</article></div>



                        </div>
                        <div class="back-top-wrapper">
                            <div class="back-top-content">
                                <i class="fa fa-angle-double-up" aria-hidden="true"></i> 
                            </div>
                        </div>

                        <div class="bottom-nav-wrapper">
                            <div class="bottom-nav-row">
                                <div class="bottom-nav text-hidden">
                                    <a href="A3MNAeYC.html" class="bottom-nav-link">上一篇</a>
                                </div>
                                <div class="bottom-nav text-hidden">
                                    <a href="YyqSLLXz.html" class="bottom-nav-link">nextDoc module</a>
                                </div>
                            </div>

                            <div class="footer-wrapper">
                                <a href="https://easydoc.net/" class="footer-link hide-ed" target="_blank">本文档使用易文档编写</a><span class="hide-ed">, </span> 更新时间: <span class="update-time">2021-09-26 00:19</span>
                            </div>
                        </div>
                    </main>
                    <aside class="content-right" style="">
                        <div class="content-right-main">
                            <div class="content-right-nav">
                                <div class="right-nav-header">
                                    <i class="fa fa-list" aria-hidden="true"></i>
                                    文章导航
                                </div>
                                <div class="right-nav-list-wrapper">
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>

        <!-- <div class="full-search-wrapper">
            <div class="full-search-content">
                <div class="full-search-input-wrapper">
                    <input type="text" class="full-search-input" placeholder="全文搜索">
                    <i class="fa fa-search" style="padding: 10px;" aria-hidden="true"></i>
                </div>

                <div class="search-result-list-wrapper"></div>
            </div>
        </div> -->

        <div class="full-search-wrapper" style="display: none;">
            <div class="full-search-input-wrapper">
                <i class="fa fa-search" aria-hidden="true"></i>
                <input class="full-search-input" type="text" placeholder="全文搜索">
            </div>
            <div class="search-result-list-wrapper">
                <div class="no-search-result" style="display:flex; align-items:center; justify-content:center; color:#999; font-size:16px; height:100%">
                    请输入关键字进行搜索
                </div>
            </div>
        </div>
    </div>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P12TJKHQ1S"></script>
    <script src=https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/axios/0.21.1/axios.min.js></script>
    <script>
        window.pid = "99888156"
        window.branchId = "v49iFg8X"
        window.did = "A3MNAeYC"
        window.docData = JSON.parse(atob(`e30=`))
        window.docType = "markdown"
        window.folderIds = ['ktzty4by']
        window.sessionStorage.setItem("domains", JSON.stringify({
            [pid]: JSON.parse(atob(`W10=`))
        }))
        window.sid = ""
        window.cid = ""
        window.lang = "zh"
        window.projectName = "Aimware Library API"

        window.themeColor = "rgb(64,158,255)"
    </script>

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-P12TJKHQ1S');
    </script>
	
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?def4eca45194cbda51c9ca177f6b0a65";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>


    <script>
        var appVersion = window.navigator.appVersion;
        var isValid = 0;
        var msg = ''
        if (appVersion.indexOf("Trident") !== -1) {
            isValid = 1;
            console.log('this is IE')
            msg = '<h3>易文档不支持当前浏览器，建议您使用 谷歌/Edge 浏览器，如果您使用的是兼容模式，请切换到非兼容模式</h3>';
        }
        else if (appVersion.indexOf("MSIE") !== -1 || !!window.ActiveXObject || "ActiveXObject" in window) {
            console.log('this is ie')
            isValid = 1;
            msg = '<h3>易文档不支持当前浏览器，建议您使用 谷歌/Edge 浏览器，如果您使用的是兼容模式，请切换到非兼容模式</h3>';
        }
        else if (appVersion.indexOf("Chrome") !== -1) {
            const regex = /Chrome\/(\d+)/i;
            const found = appVersion.match(regex);
            if (found && found.length === 2 && parseInt(found[1]) < 60) {
                isValid = 2;
                msg = '<h1>您的浏览器版本有点低，为更好的体验，建议升级到最新版本</h1>';
            }
        }
        if (isValid > 0) {
            document.body.innerHTML = msg;
        }
    </script>
</body>
</html>